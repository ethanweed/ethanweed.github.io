<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ethan Weed" />


<title>Analyzing Linear Relationships</title>

<script src="analyzing-linear-relationships_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="analyzing-linear-relationships_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="analyzing-linear-relationships_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="analyzing-linear-relationships_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="analyzing-linear-relationships_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="analyzing-linear-relationships_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="analyzing-linear-relationships_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="analyzing-linear-relationships_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="analyzing-linear-relationships_files/navigation-1.1/tabsets.js"></script>
<link href="analyzing-linear-relationships_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="analyzing-linear-relationships_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Analyzing Linear Relationships</h1>
<h4 class="author">Ethan Weed</h4>

</div>


<!-- From https://stackoverflow.com/a/37839683/1297830 -->
<link rel="stylesheet" type="text/css" href="hideOutput.css">
<script src="hideOutput.js"></script>
<div id="linear-relationships" class="section level1">
<h1>Linear Relationships</h1>
<p>One of the most basic things a researcher is interested in is seeing whether there is any relationship between variables. Here, we will look at data from Nettle (1998).</p>
<p><img src="images/Nettle_1998_abstract.png" width="460" style="display: block; margin: auto;" /></p>
<p>Nettle recorded the <em>number of languages</em>, the <em>area</em> (in km<sup>2</sup>), the <em>population</em>, the <em>mean growing season</em> (MGS, in months), the number of weather stations measuring MGS, and the standard deviation of the measurements of MGS from the different weather stations in each country.</p>
<div id="plotting-correlations" class="section level2">
<h2>Plotting Correlations</h2>
<p>We can use ggplot to see if there is any clear relationship between these variables. We might expect that there would be a relationship between the area of a country and the population of that country. We can use the <code>geom_smooth</code> and the <code>geom_point</code> functions to take a quick look.</p>
<div class="fold s">
<pre class="r"><code>rm(list = ls())

library(tidyverse)

df &lt;- read.csv(&quot;/Users/ethan/Documents/GitHub/ethanweed.github.io/r-tutorials/data/nettle_1998.csv&quot;, sep = &quot;;&quot;)

# Nettle reports the population data in 1000&#39;s, probably to save room in the data table, but that is an unusual number to think about population in, so let&#39;s convert to millions. While we&#39;re at it, let&#39;s convert km2 to millions, so that the number doesn&#39;t appear in scientific notation on the x-axis
df$Population &lt;- df$Population*1000/1000000
df$Area &lt;- df$Area/1000000

# For purposes of plotting, let&#39;s convert to a log scale
df$Population_log &lt;- log(df$Population)
df$Area_log &lt;- log(df$Area)
df$Languages_log &lt;- log(df$Languages)

p1 &lt;- ggplot(df, aes(Area_log, Languages_log)) + 
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  theme_classic() +
  labs(y = &quot;Number of languages (log)&quot;,
       x = (bquote(&#39;Area ((log) million km&#39;^2*&#39;)&#39;)),
       title = &quot;Number of Languages vs. Area&quot;)
p1</code></pre>
<p><img src="analyzing-linear-relationships_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="modelling-a-relationship-as-a-correlation" class="section level2">
<h2>Modelling a Relationship as a Correlation</h2>
<div class="fold s">
<pre class="r"><code># load pander library to make a pretty output table
library(pander)

# if you don&#39;t want to bother with the pander library, you can just write &quot;print(c)&quot; or even just &quot;(c)&quot;. Pander just makes the table output look nicer.

# do a correlation test to see how much the number of languages correlates with the area of the country
# and store the result in &quot;c&quot;
c &lt;- cor.test(df$Languages, df$Area)

# alter the contents of c$data.name so that it doesn&#39;t say e.g. &quot;df$Languages&quot; in the output table
c$data.name &lt;- &quot;Languages and Area&quot;

# output the results in a table
pander(c)</code></pre>
<table style="width:93%;">
<caption>Pearson’s product-moment correlation: <code>Languages</code> and <code>Area</code></caption>
<colgroup>
<col width="23%" />
<col width="6%" />
<col width="16%" />
<col width="34%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.576</td>
<td align="center">72</td>
<td align="center">0.01204 *</td>
<td align="center">two.sided</td>
<td align="center">0.2905</td>
</tr>
</tbody>
</table>
</div>
<p>The output tells us that there is a positive correlation between the number of languages and the area of the country. We can see this in the correlation coefficient (cor) which is 0.29. The correlation coefficient is a number between 1 and -1, with 1 indicating a perfect positive correlation, and -1 indicating a perfect negative correlation. The p-value of the correlation indicates how confident we can be in the fit of the model.</p>
</div>
<div id="correlation-matrix" class="section level2">
<h2>Correlation Matrix</h2>
<p>Sometimes it can be useful to look at all the correlations between all of the variables in a dataset at once. This can be done with a correlation matrix. However, we should be careful about reading too much into a correlation matrix: it just tells us how much the variables correlate with each other. In order to be more rigorous about making predictions, we will need to build linear models.</p>
<div class="fold s">
<pre class="r"><code>df1 &lt;- data.frame(&quot;Languages&quot; = df$Languages, &quot;Area&quot; = df$Area, &quot;Population&quot; = df$Population, &quot;MGS&quot; = df$MGS)
df1$Languages &lt;- as.numeric(df1$Languages)
pander(cor(df1))</code></pre>
<table style="width:86%;">
<colgroup>
<col width="23%" />
<col width="16%" />
<col width="13%" />
<col width="18%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Languages</th>
<th align="center">Area</th>
<th align="center">Population</th>
<th align="center">MGS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Languages</strong></td>
<td align="center">1</td>
<td align="center">0.2905</td>
<td align="center">0.4088</td>
<td align="center">0.2418</td>
</tr>
<tr class="even">
<td align="center"><strong>Area</strong></td>
<td align="center">0.2905</td>
<td align="center">1</td>
<td align="center">0.3331</td>
<td align="center">-0.1277</td>
</tr>
<tr class="odd">
<td align="center"><strong>Population</strong></td>
<td align="center">0.4088</td>
<td align="center">0.3331</td>
<td align="center">1</td>
<td align="center">-0.01717</td>
</tr>
<tr class="even">
<td align="center"><strong>MGS</strong></td>
<td align="center">0.2418</td>
<td align="center">-0.1277</td>
<td align="center">-0.01717</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="modelling-a-relationship-as-a-linear-regression" class="section level2">
<h2>Modelling a Relationship as a Linear Regression</h2>
<p>In the plot above, we used a so-called linear model to draw the line between the points. The straight line in the plot is a linear model, that minimizes the distance between the line and every individual point. If we generate some random numbers to create white noise, then the line should be close to horizontal. Here we see a linear model of 1000 random numbers between 0 and 100 plotted against 1000 other random numbers between 0 and 100:</p>
<div class="fold s">
<pre class="r"><code>set.seed(42)

x = runif(1000, min=0, max=100)
y = runif(1000, min=0, max=100)

df_random &lt;- data.frame(&quot;x&quot; = x, &quot;y&quot; = y)

ggplot(data = df_random, aes(x,y)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  theme_classic() +
  labs(title = &quot;White Noise&quot;)</code></pre>
<p><img src="analyzing-linear-relationships_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<p>If we were in doubt, our correlation matrix shows us that there is very little correlation between these two vectors of random numbers:</p>
<pre class="r"><code>pander((cor(df_random)))</code></pre>
<table style="width:49%;">
<colgroup>
<col width="12%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">x</th>
<th align="center">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>x</strong></td>
<td align="center">1</td>
<td align="center">-0.0004327</td>
</tr>
<tr class="even">
<td align="center"><strong>y</strong></td>
<td align="center">-0.0004327</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>If we want to go beyond simply observing the correlation and instead use our linear model to make predictions about new data that we have not yet seen, we need to get the equation for our model’s line. That will allow us to extend the line in either direction, and make predictions.</p>
<p>The equation of a line is <span class="math inline">\(y=mx+y_0\)</span>, where <span class="math inline">\(y_0\)</span> is the point at which the line intercepts the y-axis. This is sometimes also written as <span class="math inline">\(y=mx+b\)</span>, or <span class="math inline">\(y=ax+b\)</span>. These equations are all equivalant. The important thing for our purposes is that they define the slope and intercept of a line which represents a <em>linear model</em> of the data.</p>
<p>Linear models are <em>very</em> useful, and they are all over the place in statistics. In the case of our random, white-noise data, because the slope is nearly equal to zero, the intercept of the model is a very close approximation of the mean of y:</p>
<pre class="r"><code>print(mean(y))</code></pre>
<pre><code>## [1] 49.70157</code></pre>
<pre class="r"><code>pander(summary(lm(data = df_random, y ~ x)))</code></pre>
<table style="width:92%;">
<colgroup>
<col width="25%" />
<col width="18%" />
<col width="18%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">49.72</td>
<td align="center">1.829</td>
<td align="center">27.19</td>
<td align="center">2.86e-122</td>
</tr>
<tr class="even">
<td align="center"><strong>x</strong></td>
<td align="center">-0.0004397</td>
<td align="center">0.03217</td>
<td align="center">-0.01367</td>
<td align="center">0.9891</td>
</tr>
</tbody>
</table>
<table style="width:90%;">
<caption>Fitting linear model: y ~ x</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="16%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1000</td>
<td align="center">29.63</td>
<td align="center">1.872e-07</td>
<td align="center">-0.001002</td>
</tr>
</tbody>
</table>
<pre class="r"><code>mod &lt;- lm(data = df, Languages ~ Area)

# if you don&#39;t want to use pander you can just write: summary(mod)
pander(summary(mod))</code></pre>
<table style="width:86%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">63.37</td>
<td align="center">19.12</td>
<td align="center">3.315</td>
<td align="center">0.001437</td>
</tr>
<tr class="even">
<td align="center"><strong>Area</strong></td>
<td align="center">29.93</td>
<td align="center">11.62</td>
<td align="center">2.576</td>
<td align="center">0.01204</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: Languages ~ Area</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="13%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">74</td>
<td align="center">138.9</td>
<td align="center">0.08439</td>
<td align="center">0.07167</td>
</tr>
</tbody>
</table>
</div>
<div id="modelling-multiple-predictor-variables-in-a-linear-regression" class="section level2">
<h2>Modelling Multiple Predictor Variables in a Linear Regression</h2>
<div class="fold s">
<pre class="r"><code>mod &lt;- lm(data = df, Languages ~ Area + Population)
pander(summary(mod))</code></pre>
<table style="width:86%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">57.29</td>
<td align="center">18.17</td>
<td align="center">3.153</td>
<td align="center">0.002366</td>
</tr>
<tr class="even">
<td align="center"><strong>Area</strong></td>
<td align="center">17.89</td>
<td align="center">11.64</td>
<td align="center">1.536</td>
<td align="center">0.1289</td>
</tr>
<tr class="odd">
<td align="center"><strong>Population</strong></td>
<td align="center">0.495</td>
<td align="center">0.1594</td>
<td align="center">3.105</td>
<td align="center">0.002731</td>
</tr>
</tbody>
</table>
<table style="width:86%;">
<caption>Fitting linear model: Languages ~ Area + Population</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">74</td>
<td align="center">131.2</td>
<td align="center">0.1939</td>
<td align="center">0.1712</td>
</tr>
</tbody>
</table>
<pre class="r"><code># or you can just write: summary(mod)</code></pre>
</div>
<div class="fold s">
<pre class="r"><code>library(ggpubr)

p1 &lt;- ggplot(df, aes(Area_log, Languages_log)) + 
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  theme_classic() +
  labs(y = &quot;Number of languages (log)&quot;,
       x = (bquote(&#39;Area ((log) million km&#39;^2*&#39;)&#39;)),
       title = &quot;Languages vs. Area&quot;)


p2 &lt;- ggplot(df, aes(Population_log, Languages_log)) + 
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  theme_classic() +
  labs(y = &quot;Number of languages (log)&quot;,
       x = &quot;Population in Millions (log)&quot;,
       title = &quot;Languages vs. Population&quot;)

ggarrange(p1, p2, ncol = 2)</code></pre>
<p><img src="analyzing-linear-relationships_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
